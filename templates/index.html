<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShiroBurn</title>
    
    <!-- Google AdSense ê´‘ê³  ìŠ¤í¬ë¦½íŠ¸ -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9604512601494581"
            crossorigin="anonymous"></script>
    
    <!-- Chart.js ì¶”ê°€ (ê·¸ë˜í”„ìš©) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        async function fetchBurnData() {
            try {
                // ì´ ì†Œê°ëŸ‰ ê°€ì ¸ì˜¤ê¸°
                const responseBurned = await fetch("/api/burned");
                const dataBurned = await responseBurned.json();
                console.log("ğŸ”¥ API ì‘ë‹µ ë°ì´í„°:", dataBurned); // ë””ë²„ê¹…ìš©

                if (dataBurned && dataBurned.total_burned !== undefined) {
                    document.getElementById("burnedAmount").textContent = dataBurned.total_burned.toFixed(2) + " $SHIRO";
                } else {
                    document.getElementById("burnedAmount").textContent = "ë°ì´í„° ì˜¤ë¥˜";
                }

                // Burn Rate ê°€ì ¸ì˜¤ê¸°
                const responseRate = await fetch("/api/burn-rate");
                const dataRate = await responseRate.json();

                document.getElementById("burnRate").textContent = dataRate.burn_rate.toFixed(2) + "% ğŸ¢";
                document.getElementById("burnAmount24h").textContent = `Last 24hrs (${dataRate.burn_amount_24h.toLocaleString()} $SHIRO)`;

                // ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
                updateChart(dataRate.burn_amount_24h);
            } catch (error) {
                console.error("âŒ Error fetching burn data:", error);
            }
        }

        function updateChart(burnAmount) {
            burnChart.data.datasets[0].data.push(burnAmount);
            burnChart.data.labels.push(new Date().toLocaleTimeString());
            burnChart.update();
        }

        setInterval(fetchBurnData, 60000); // 1ë¶„ë§ˆë‹¤ ê°±ì‹ 
        window.onload = function() {
            fetchBurnData();

            // ê´‘ê³  ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¥¼ 3ì´ˆ ì§€ì—°í•˜ì—¬ ì‹¤í–‰
            setTimeout(function() {
                console.log("ğŸ“¢ Google AdSense ê´‘ê³  ë¡œë“œ ì‹œì‘");
                (adsbygoogle = window.adsbygoogle || []).push({});
            }, 3000);
        };
    </script>
</head>
<body>
    <h1>ğŸ”¥ $Shiro Neko Supply ğŸ”¥</h1>
    <p>Total burnt from initial supply: <span id="burnedAmount">Loading...</span></p>
    <p>Burn Rate: <span id="burnRate">Loading...</span></p>
    <p><span id="burnAmount24h"></span></p>

    <!-- Burn Rate ê·¸ë˜í”„ -->
    <canvas id="burnRateChart" width="400" height="200"></canvas>

    <script>
        var ctx = document.getElementById('burnRateChart').getContext('2d');
        var burnChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Burn Amount (Last 24h)',
                    data: [],
                    borderColor: 'red',
                    borderWidth: 2,
                    fill: false
                }]
            },
            options: {
                scales: {
                    x: {
                        title: { display: true, text: 'Time' }
                    },
                    y: {
                        title: { display: true, text: 'Burn Amount' }
                    }
                }
            }
        });
    </script>

    <!-- Google AdSense ê´‘ê³  (í˜ì´ì§€ ìƒë‹¨) -->
    <div style="text-align: center; margin: 20px 0;">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="pub-9604512601494581"
             data-ad-slot="5372001330"
             data-ad-format="auto"></ins>
    </div>

    <!-- ì¶”ê°€ ê´‘ê³  ì˜ì—­ (í•˜ë‹¨ ë°°ë„ˆ) -->
    <div style="text-align: center; margin: 40px 0;">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="pub-9604512601494581"
             data-ad-slot="5372001330"
             data-ad-format="horizontal"></ins>
    </div>
</body>
</html>
